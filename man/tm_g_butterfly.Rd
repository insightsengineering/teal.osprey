% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tm_g_butterfly.R
\name{tm_g_butterfly}
\alias{tm_g_butterfly}
\title{Butterfly plot Teal Module}
\usage{
tm_g_butterfly(
  label,
  dataname,
  filter_var = NULL,
  right_var,
  left_var,
  category_var,
  color_by_var,
  count_by_var,
  facet_var = NULL,
  sort_by_var = teal.transform::choices_selected(selected = "count", choices = c("count",
    "alphabetical")),
  legend_on = TRUE,
  plot_height = c(600L, 200L, 2000L),
  plot_width = NULL,
  pre_output = NULL,
  post_output = NULL
)
}
\arguments{
\item{label}{(\code{character(1)})\cr
menu item label of the module in the teal app.}

\item{dataname}{(\code{character(1)})\cr
analysis data used in the teal module, needs to be
available in the list passed to the \code{data} argument of \code{\link[teal:init]{teal::init()}}.}

\item{filter_var}{(\code{choices_selected}) variable name of data filter, please see details regarding
expected values, default is \code{NULL}. \code{choices}
vector with \code{filter_var} choices, default is
\code{NULL}}

\item{right_var}{(\code{choices_selected}) dichotomization variable for right side}

\item{left_var}{(\code{choices_selected}) dichotomization variable for left side}

\item{category_var}{(\code{choices_selected}) category (y axis) variable}

\item{color_by_var}{(\code{choices_selected}) variable defines color blocks within each bar}

\item{count_by_var}{(\code{choices_selected}) variable defines how x axis is calculated}

\item{facet_var}{(\code{choices_selected}) variable for row facets}

\item{sort_by_var}{(\code{choices_selected}) argument for order of class and term elements in table,
default here is "count"}

\item{legend_on}{(\code{boolean}) value for whether legend is displayed}

\item{plot_height}{(\code{numeric(3)})\cr
vector to indicate default value, minimum and maximum values.}

\item{plot_width}{(\code{numeric(3)})\cr
vector to indicate default value, minimum and maximum values.}

\item{pre_output}{(\code{shiny.tag}, optional)\cr
with text placed before the output to put the output into context. For example a title.}

\item{post_output}{(\code{shiny.tag}, optional) with text placed after the output to put the output
into context. For example the \code{\link[shiny:helpText]{shiny::helpText()}} elements are useful.}
}
\value{
the \code{\link[teal:teal_modules]{teal::module()}} object.
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#stable}{\figure{lifecycle-stable.svg}{options: alt='[Stable]'}}}{\strong{[Stable]}}

Display butterfly plot as a shiny module
}
\details{
\code{filter_var} option is designed to work in conjunction with
filtering function provided by \code{teal} (encoding panel on the right
hand side of the shiny app). It can be used as quick access to predefined
subsets of the domain datasets (not subject-level dataset) to be used for
analysis, denoted by an value of "Y". Each variable within the
\code{filter_var_choices} is expected to contain values of either "Y" or
"N". If multiple variables are selected as \code{filter_var}, only
observations with "Y" value in each and every selected variables will be
used for subsequent analysis. Flag variables (from \code{ADaM} datasets) can be
used directly as filter.
}
\examples{
# Example using stream (ADaM) dataset
data <- cdisc_data() |>
  within({
    library(dplyr)
    library(nestcolor)
    set.seed(23)
    ADSL <- rADSL
    ADAE <- rADAE
    ADSL <- mutate(ADSL, DOSE = paste(sample(1:3, n(), replace = TRUE), "UG"))
    ADAE <- mutate(
      ADAE,
      flag1 = ifelse(AETOXGR == 1, 1, 0),
      flag2 = ifelse(AETOXGR == 2, 1, 0),
      flag3 = ifelse(AETOXGR == 3, 1, 0),
      flag1_filt = rep("Y", n())
    )
  })

datanames(data) <- c("ADSL", "ADAE")
join_keys(data) <- default_cdisc_join_keys[datanames(data)]

app <- init(
  data = data,
  modules = modules(
    tm_g_butterfly(
      label = "Butterfly Plot",
      dataname = "ADAE",
      right_var = choices_selected(
        selected = "SEX",
        choices = c("SEX", "ARM", "RACE")
      ),
      left_var = choices_selected(
        selected = "RACE",
        choices = c("SEX", "ARM", "RACE")
      ),
      category_var = choices_selected(
        selected = "AEBODSYS",
        choices = c("AEDECOD", "AEBODSYS")
      ),
      color_by_var = choices_selected(
        selected = "AETOXGR",
        choices = c("AETOXGR", "None")
      ),
      count_by_var = choices_selected(
        selected = "# of patients",
        choices = c("# of patients", "# of AEs")
      ),
      facet_var = choices_selected(
        selected = NULL,
        choices = c("RACE", "SEX", "ARM")
      ),
      sort_by_var = choices_selected(
        selected = "count",
        choices = c("count", "alphabetical")
      ),
      legend_on = TRUE,
      plot_height = c(600, 200, 2000)
    )
  )
)
if (interactive()) {
  shinyApp(app$ui, app$server)
}

}
\author{
Carolyn Zhang (zhanc107) \email{carolyn.zhang@duke.edu}

Chendi Liao (liaoc10) \email{chendi.liao@roche.com}
}
